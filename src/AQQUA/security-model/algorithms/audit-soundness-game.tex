% --------- Audit soundness game ---------
\begin{game}[htbp]
    \DontPrintSemicolon
    \SetAlgoLined
    \caption{Audit soundness game $\exper^{\auditsoundness}_{\adv, f}(\secpar)$}
    \label{alg:audit-soundness-game}
    \SetKwInOut{Input}{Input}
    \SetKwInOut{Output}{Output}
    \Input{$\secpar$}
    \Output{$\{0,1\}$}
    \BlankLine

    $b\gets \{0, 1\}$ \;
    $\instate, \params \gets \setup(\secpar)$ \;
    $(\inpk, \snap_1, \snap_2, f, \aux, \auditinfo) \gets \adv^{\corruptOracle, \regOracle, \createAcctOracle, \deleteAcctOracle, \transOracle, \applytxnOracle, \auditOracle}(\instate)$ \;
    \If{$\vera(\inpk, \snap_1, \snap_2, (f,\aux), \auditinfo)=1$}{
        \tcp*{run bookkeeping and check if $f$ is satisfied and that $\snap_1, \snap_2$ are valid}
        \If{$\verifypolicy(\inpk, \snap_1, \snap_2, (f,\aux)) = 1$}{
            \Return{$0$}
        } \Else{\Return{$1$}}
    } \Else{
        \Return{$\bot$}
    }
\end{game}


% \begin{algorithm}[htbp]
%     \DontPrintSemicolon
%     \SetAlgoLined
%     \caption{Audit soundness game $\exper^{\auditsoundness}_{\adv, f}(\secpar)$}
%     \label{alg:audit-soundness-game}
%     \SetKwInOut{Input}{Input}
%     \SetKwInOut{Output}{Output}
%     \Input{$\secpar$}
%     \Output{$\{0,1\}$}
%     \BlankLine

%     $b\gets \{0, 1\}$ \;
%     $\instate, \params \gets \setup(\secpar)$ \;
%     $(\inpk, \snap_1, \snap_2, f, \aux, {\numaccs}_1, \{ {\acct_1}_{i} \}_{i=1}^{\numaccs_1}, {\numaccs}_2, \{ {\acct_2}_{i} \}_{i=1}^{\numaccs_2}, \pi) \gets \adv^{\corruptAcctOracle, \corruptUserOracle, \regOracle, \createAcctOracle, \transOracle, \auditOracle}(\instate)$ \;
%     \If{$\vera(\inpk, \snap_1, \snap_2, {\numaccs}_1, \{ {\acct_1}_{i} \}_{i=1}^{\numaccs_1}, {\numaccs}_2, \{ {\acct_2}_{i} \}_{i=1}^{\numaccs_2}, (f,\aux), \pi)=1$}{
%         \tcp*{run bookkeeping and check if $f$ is satisfied and that $\snap_1, \snap_2$ are valid}
%         \If{$\bookkeepingfunctionality.\verifypolicy(\inpk, \snap_1, \snap_2, f,\aux) = 1$}{
%             \Return{$0$}
%         } \Else{\Return{$1$}}
%     } \Else{
%         \Return{$\bot$}
%     }

     

% \end{algorithm}

% --------- End audit correctness game ---------
