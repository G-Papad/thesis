\subsection{Commitments}
We use a commitment scheme $\commit$ relative to a public key $\pk$ that, given a message $m \in \msgspace$ and randomness $r \in \randspace$,
computes $\comm{m} \gets \commit(\pk, m;r)$. 
Our commitments must satisfy the following properties: 
\begin{itemize}
    \item \textbf{Computational hiding}: An adversary has negligible advantage in distinguishing between $\commit(\pk, m_0;r_0)$ 
    and $\commit(\pk, m_1;r_1)$, where $r_0, r_1 \sample \randspace$.
    \item \textbf{Unconditional binding}: A commitment cannot be opened to two different messages, even with the knowledge of the secret key $\sk$.
    \item \textbf{Additively homomorphic}: For given operation $\odot$ it holds that \\
     $\commit(\pk, m;r) \odot \commit(\pk, m';r') = \commit(\pk, m+m';r+r')$.
    \item \textbf{Key-anonymous}: An adversary cannot distinguish between \\
     $(m, \pk_0, \pk_1, \commit(\pk_0, m))$ and $(m, \pk_0, \pk_1, \commit(\pk_1, m))$ for any honestly generated public keys $\pk_0, \pk_1$ and adversarially chosen message $m$.
\end{itemize}

We construct such a scheme using the unconditionally binding commitments of~\cite{fauzi2019quisquis}. They are defined in a prime-order $p$ group $(\group, g, p)$ generated by $g$, where the $\ddh$ problem is hard.
In essence, ElGamal `encryption' is used in the exponent where the public keys are of the form $\pk = (g, h) \in \group^2$. 
Specifically,  
 $\commit(\pk, m; r)$ yields $\comm{m} = (c, d)$, where $c = g_i^r$ and $d = g^m h_i^r$.

 Using UKPs as the commitment public keys, one can verify and open commitments using the secret key, without needing to know the randomness used.
\begin{itemize}
    \item $\verifycom(\sk, \pk, \com, m)$: Checks if $\com = (c,d)$ is a commitment to $m$ under $\pk$, by checking if $ d = g^m c^\sk $ holds.
    % \item $\verifycom(\pk, \com, m, r)$: Checks if $\com = (c,d)$ is a commitment to $m$ under $\pk$ with randomness $r$, by checking if $c = g^r$ and $d = g^m h^r$.
    \item $\opencom(\sk, \comm{m})$: Given $\comm{m} = (c, d)$, calculates $m$ by calculating $dc^{-\sk}$ and brute-forcing to obtain $m$.
\end{itemize}